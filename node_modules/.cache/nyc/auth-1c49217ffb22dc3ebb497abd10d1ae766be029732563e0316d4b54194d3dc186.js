function cov_cefwcqtdu(){var path="C:\\Users\\Tri Le\\Documents\\Projects\\blog-app\\routes\\auth.js";var hash="8b90840c466a8bfc13f79c831c2be053a1f5228d";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\Tri Le\\Documents\\Projects\\blog-app\\routes\\auth.js",statementMap:{"0":{start:{line:1,column:12},end:{line:1,column:35}},"1":{start:{line:4,column:2},end:{line:8,column:5}},"2":{start:{line:5,column:4},end:{line:6,column:52}},"3":{start:{line:6,column:6},end:{line:6,column:52}},"4":{start:{line:7,column:4},end:{line:7,column:11}},"5":{start:{line:12,column:2},end:{line:16,column:5}},"6":{start:{line:13,column:4},end:{line:14,column:52}},"7":{start:{line:14,column:6},end:{line:14,column:52}},"8":{start:{line:15,column:4},end:{line:15,column:11}},"9":{start:{line:20,column:16},end:{line:20,column:40}},"10":{start:{line:21,column:2},end:{line:21,column:60}},"11":{start:{line:21,column:14},end:{line:21,column:60}},"12":{start:{line:22,column:2},end:{line:28,column:3}},"13":{start:{line:23,column:21},end:{line:23,column:64}},"14":{start:{line:24,column:4},end:{line:24,column:24}},"15":{start:{line:25,column:4},end:{line:25,column:11}},"16":{start:{line:27,column:4},end:{line:27,column:43}},"17":{start:{line:31,column:0},end:{line:31,column:61}}},fnMap:{"0":{name:"verifySelf",decl:{start:{line:3,column:9},end:{line:3,column:19}},loc:{start:{line:3,column:36},end:{line:9,column:1}},line:3},"1":{name:"(anonymous_1)",decl:{start:{line:4,column:27},end:{line:4,column:28}},loc:{start:{line:4,column:33},end:{line:8,column:3}},line:4},"2":{name:"verifyOwner",decl:{start:{line:11,column:9},end:{line:11,column:20}},loc:{start:{line:11,column:37},end:{line:17,column:1}},line:11},"3":{name:"(anonymous_3)",decl:{start:{line:12,column:27},end:{line:12,column:28}},loc:{start:{line:12,column:33},end:{line:16,column:3}},line:12},"4":{name:"verifyLoggedIn",decl:{start:{line:19,column:9},end:{line:19,column:23}},loc:{start:{line:19,column:40},end:{line:29,column:1}},line:19}},branchMap:{"0":{loc:{start:{line:5,column:4},end:{line:6,column:52}},type:"if",locations:[{start:{line:5,column:4},end:{line:6,column:52}},{start:{line:5,column:4},end:{line:6,column:52}}],line:5},"1":{loc:{start:{line:13,column:4},end:{line:14,column:52}},type:"if",locations:[{start:{line:13,column:4},end:{line:14,column:52}},{start:{line:13,column:4},end:{line:14,column:52}}],line:13},"2":{loc:{start:{line:21,column:2},end:{line:21,column:60}},type:"if",locations:[{start:{line:21,column:2},end:{line:21,column:60}},{start:{line:21,column:2},end:{line:21,column:60}}],line:21}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0},b:{"0":[0,0],"1":[0,0],"2":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"8b90840c466a8bfc13f79c831c2be053a1f5228d"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_cefwcqtdu=function(){return actualCoverage;};}return actualCoverage;}cov_cefwcqtdu();const jwt=(cov_cefwcqtdu().s[0]++,require('jsonwebtoken'));function verifySelf(req,res,next){cov_cefwcqtdu().f[0]++;cov_cefwcqtdu().s[1]++;verifyLoggedIn(req,res,()=>{cov_cefwcqtdu().f[1]++;cov_cefwcqtdu().s[2]++;if(req.user._id!==req.params.id){cov_cefwcqtdu().b[0][0]++;cov_cefwcqtdu().s[3]++;return res.status(401).send('Access Denied.');}else{cov_cefwcqtdu().b[0][1]++;}cov_cefwcqtdu().s[4]++;next();});}function verifyOwner(req,res,next){cov_cefwcqtdu().f[2]++;cov_cefwcqtdu().s[5]++;verifyLoggedIn(req,res,()=>{cov_cefwcqtdu().f[3]++;cov_cefwcqtdu().s[6]++;if(req.user._id!==req.post.userId){cov_cefwcqtdu().b[1][0]++;cov_cefwcqtdu().s[7]++;return res.status(401).send('Access Denied.');}else{cov_cefwcqtdu().b[1][1]++;}cov_cefwcqtdu().s[8]++;next();});}function verifyLoggedIn(req,res,next){cov_cefwcqtdu().f[4]++;const token=(cov_cefwcqtdu().s[9]++,req.header('auth-token'));cov_cefwcqtdu().s[10]++;if(!token){cov_cefwcqtdu().b[2][0]++;cov_cefwcqtdu().s[11]++;return res.status(401).send('Access Denied.');}else{cov_cefwcqtdu().b[2][1]++;}cov_cefwcqtdu().s[12]++;try{const verified=(cov_cefwcqtdu().s[13]++,jwt.verify(token,process.env.TOKEN_SECRET));cov_cefwcqtdu().s[14]++;req.user=verified;cov_cefwcqtdu().s[15]++;next();}catch(error){cov_cefwcqtdu().s[16]++;res.status(401).send('Access Denied.');}}cov_cefwcqtdu().s[17]++;module.exports={verifySelf,verifyOwner,verifyLoggedIn};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF1dGguanMiXSwibmFtZXMiOlsiand0IiwicmVxdWlyZSIsInZlcmlmeVNlbGYiLCJyZXEiLCJyZXMiLCJuZXh0IiwidmVyaWZ5TG9nZ2VkSW4iLCJ1c2VyIiwiX2lkIiwicGFyYW1zIiwiaWQiLCJzdGF0dXMiLCJzZW5kIiwidmVyaWZ5T3duZXIiLCJwb3N0IiwidXNlcklkIiwidG9rZW4iLCJoZWFkZXIiLCJ2ZXJpZmllZCIsInZlcmlmeSIsInByb2Nlc3MiLCJlbnYiLCJUT0tFTl9TRUNSRVQiLCJlcnJvciIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiJrZ0dBZVk7eUZBZlosS0FBTUEsQ0FBQUEsR0FBRyx5QkFBR0MsT0FBTyxDQUFDLGNBQUQsQ0FBVixDQUFULENBRUEsUUFBU0MsQ0FBQUEsVUFBVCxDQUFvQkMsR0FBcEIsQ0FBeUJDLEdBQXpCLENBQThCQyxJQUE5QixDQUFvQywrQ0FDbENDLGNBQWMsQ0FBQ0gsR0FBRCxDQUFNQyxHQUFOLENBQVcsSUFBTSwrQ0FDN0IsR0FBSUQsR0FBRyxDQUFDSSxJQUFKLENBQVNDLEdBQVQsR0FBaUJMLEdBQUcsQ0FBQ00sTUFBSixDQUFXQyxFQUFoQyxDQUNFLHdEQUFPTixDQUFBQSxHQUFHLENBQUNPLE1BQUosQ0FBVyxHQUFYLEVBQWdCQyxJQUFoQixDQUFxQixnQkFBckIsQ0FBUCxDQUE4QyxDQURoRCxnQ0FENkIsdUJBRzdCUCxJQUFJLEdBQ0wsQ0FKYSxDQUFkLENBS0QsQ0FFRCxRQUFTUSxDQUFBQSxXQUFULENBQXFCVixHQUFyQixDQUEwQkMsR0FBMUIsQ0FBK0JDLElBQS9CLENBQXFDLCtDQUNuQ0MsY0FBYyxDQUFDSCxHQUFELENBQU1DLEdBQU4sQ0FBVyxJQUFNLCtDQUM3QixHQUFJRCxHQUFHLENBQUNJLElBQUosQ0FBU0MsR0FBVCxHQUFpQkwsR0FBRyxDQUFDVyxJQUFKLENBQVNDLE1BQTlCLENBQ0Usd0RBQU9YLENBQUFBLEdBQUcsQ0FBQ08sTUFBSixDQUFXLEdBQVgsRUFBZ0JDLElBQWhCLENBQXFCLGdCQUFyQixDQUFQLENBQThDLENBRGhELGdDQUQ2Qix1QkFHN0JQLElBQUksR0FDTCxDQUphLENBQWQsQ0FLRCxDQUVELFFBQVNDLENBQUFBLGNBQVQsQ0FBd0JILEdBQXhCLENBQTZCQyxHQUE3QixDQUFrQ0MsSUFBbEMsQ0FBd0Msd0JBQ3RDLEtBQU1XLENBQUFBLEtBQUsseUJBQUdiLEdBQUcsQ0FBQ2MsTUFBSixDQUFXLFlBQVgsQ0FBSCxDQUFYLENBRHNDLHdCQUV0QyxHQUFJLENBQUNELEtBQUwsQ0FBWSx5REFBT1osQ0FBQUEsR0FBRyxDQUFDTyxNQUFKLENBQVcsR0FBWCxFQUFnQkMsSUFBaEIsQ0FBcUIsZ0JBQXJCLENBQVAsQ0FBOEMsQ0FBMUQsZ0NBRnNDLHdCQUd0QyxHQUFJLENBQ0YsS0FBTU0sQ0FBQUEsUUFBUSwwQkFBR2xCLEdBQUcsQ0FBQ21CLE1BQUosQ0FBV0gsS0FBWCxDQUFrQkksT0FBTyxDQUFDQyxHQUFSLENBQVlDLFlBQTlCLENBQUgsQ0FBZCxDQURFLHdCQUVGbkIsR0FBRyxDQUFDSSxJQUFKLENBQVdXLFFBQVgsQ0FGRSx3QkFHRmIsSUFBSSxHQUNMLENBQUMsTUFBT2tCLEtBQVAsQ0FBYyx5QkFDZG5CLEdBQUcsQ0FBQ08sTUFBSixDQUFXLEdBQVgsRUFBZ0JDLElBQWhCLENBQXFCLGdCQUFyQixFQUNELENBQ0YsQyx3QkFFRFksTUFBTSxDQUFDQyxPQUFQLENBQWlCLENBQUV2QixVQUFGLENBQWNXLFdBQWQsQ0FBMkJQLGNBQTNCLENBQWpCIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3Qgand0ID0gcmVxdWlyZSgnanNvbndlYnRva2VuJyk7XHJcblxyXG5mdW5jdGlvbiB2ZXJpZnlTZWxmKHJlcSwgcmVzLCBuZXh0KSB7XHJcbiAgdmVyaWZ5TG9nZ2VkSW4ocmVxLCByZXMsICgpID0+IHtcclxuICAgIGlmIChyZXEudXNlci5faWQgIT09IHJlcS5wYXJhbXMuaWQpXHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuc2VuZCgnQWNjZXNzIERlbmllZC4nKTtcclxuICAgIG5leHQoKTtcclxuICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gdmVyaWZ5T3duZXIocmVxLCByZXMsIG5leHQpIHtcclxuICB2ZXJpZnlMb2dnZWRJbihyZXEsIHJlcywgKCkgPT4ge1xyXG4gICAgaWYgKHJlcS51c2VyLl9pZCAhPT0gcmVxLnBvc3QudXNlcklkKVxyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLnNlbmQoJ0FjY2VzcyBEZW5pZWQuJyk7XHJcbiAgICBuZXh0KCk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHZlcmlmeUxvZ2dlZEluKHJlcSwgcmVzLCBuZXh0KSB7XHJcbiAgY29uc3QgdG9rZW4gPSByZXEuaGVhZGVyKCdhdXRoLXRva2VuJyk7XHJcbiAgaWYgKCF0b2tlbikgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5zZW5kKCdBY2Nlc3MgRGVuaWVkLicpO1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB2ZXJpZmllZCA9IGp3dC52ZXJpZnkodG9rZW4sIHByb2Nlc3MuZW52LlRPS0VOX1NFQ1JFVCk7XHJcbiAgICByZXEudXNlciA9IHZlcmlmaWVkO1xyXG4gICAgbmV4dCgpO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICByZXMuc3RhdHVzKDQwMSkuc2VuZCgnQWNjZXNzIERlbmllZC4nKTtcclxuICB9XHJcbn1cclxuXHJcbm1vZHVsZS5leHBvcnRzID0geyB2ZXJpZnlTZWxmLCB2ZXJpZnlPd25lciwgdmVyaWZ5TG9nZ2VkSW4gfTsiXX0=